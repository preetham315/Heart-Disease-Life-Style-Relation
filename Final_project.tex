% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Final\_project.R},
  pdfauthor={vinnamala},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Final\_project.R}
\author{vinnamala}
\date{2023-04-24}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the required libraries}
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
## v dplyr     1.1.2     v readr     2.1.4
## v forcats   1.0.0     v stringr   1.5.0
## v ggplot2   3.4.1     v tibble    3.2.1
## v lubridate 1.9.2     v tidyr     1.3.0
## v purrr     1.0.1     
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
## i Use the ]8;;http://conflicted.r-lib.org/conflicted package]8;; to force all conflicts to become errors
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(magrittr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'magrittr'
## 
## The following object is masked from 'package:purrr':
## 
##     set_names
## 
## The following object is masked from 'package:tidyr':
## 
##     extract
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(viridis)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: viridisLite
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(scales)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'scales'
## 
## The following object is masked from 'package:viridis':
## 
##     viridis_pal
## 
## The following object is masked from 'package:purrr':
## 
##     discard
## 
## The following object is masked from 'package:readr':
## 
##     col_factor
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Read in the dataset}
\NormalTok{heart\_data }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"heart\_2020\_cleaned.csv"}\NormalTok{)}

\CommentTok{\# Explore the structure and summary of the dataset}
\FunctionTok{str}\NormalTok{(heart\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    319795 obs. of  18 variables:
##  $ HeartDisease    : chr  "No" "No" "No" "No" ...
##  $ BMI             : num  16.6 20.3 26.6 24.2 23.7 ...
##  $ Smoking         : chr  "Yes" "No" "Yes" "No" ...
##  $ AlcoholDrinking : chr  "No" "No" "No" "No" ...
##  $ Stroke          : chr  "No" "Yes" "No" "No" ...
##  $ PhysicalHealth  : num  3 0 20 0 28 6 15 5 0 0 ...
##  $ MentalHealth    : num  30 0 30 0 0 0 0 0 0 0 ...
##  $ DiffWalking     : chr  "No" "No" "No" "No" ...
##  $ Sex             : chr  "Female" "Female" "Male" "Female" ...
##  $ AgeCategory     : chr  "55-59" "80 or older" "65-69" "75-79" ...
##  $ Race            : chr  "White" "White" "White" "White" ...
##  $ Diabetic        : chr  "Yes" "No" "Yes" "No" ...
##  $ PhysicalActivity: chr  "Yes" "Yes" "Yes" "No" ...
##  $ GenHealth       : chr  "Very good" "Very good" "Fair" "Good" ...
##  $ SleepTime       : num  5 7 8 6 8 12 4 9 5 10 ...
##  $ Asthma          : chr  "Yes" "No" "Yes" "No" ...
##  $ KidneyDisease   : chr  "No" "No" "No" "No" ...
##  $ SkinCancer      : chr  "Yes" "No" "No" "Yes" ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(heart\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  HeartDisease            BMI          Smoking          AlcoholDrinking   
##  Length:319795      Min.   :12.02   Length:319795      Length:319795     
##  Class :character   1st Qu.:24.03   Class :character   Class :character  
##  Mode  :character   Median :27.34   Mode  :character   Mode  :character  
##                     Mean   :28.33                                        
##                     3rd Qu.:31.42                                        
##                     Max.   :94.85                                        
##     Stroke          PhysicalHealth    MentalHealth    DiffWalking       
##  Length:319795      Min.   : 0.000   Min.   : 0.000   Length:319795     
##  Class :character   1st Qu.: 0.000   1st Qu.: 0.000   Class :character  
##  Mode  :character   Median : 0.000   Median : 0.000   Mode  :character  
##                     Mean   : 3.372   Mean   : 3.898                     
##                     3rd Qu.: 2.000   3rd Qu.: 3.000                     
##                     Max.   :30.000   Max.   :30.000                     
##      Sex            AgeCategory            Race             Diabetic        
##  Length:319795      Length:319795      Length:319795      Length:319795     
##  Class :character   Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
##                                                                             
##                                                                             
##                                                                             
##  PhysicalActivity    GenHealth           SleepTime         Asthma         
##  Length:319795      Length:319795      Min.   : 1.000   Length:319795     
##  Class :character   Class :character   1st Qu.: 6.000   Class :character  
##  Mode  :character   Mode  :character   Median : 7.000   Mode  :character  
##                                        Mean   : 7.097                     
##                                        3rd Qu.: 8.000                     
##                                        Max.   :24.000                     
##  KidneyDisease       SkinCancer       
##  Length:319795      Length:319795     
##  Class :character   Class :character  
##  Mode  :character   Mode  :character  
##                                       
##                                       
## 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(heart\_data))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#The density plot shows the estimated probability density function of the BMI }
\CommentTok{\#values in the dataset. The height of the curve at a given point represents the}
\CommentTok{\#estimated probability that a randomly selected BMI value from the dataset will }
\CommentTok{\#fall within a small range of values around that point.}

\CommentTok{\#In the context of the plot you mentioned, the density on the right{-}hand side }
\CommentTok{\#of the plot indicates that BMI values in the dataset are more concentrated in }
\CommentTok{\#that range, meaning there are more individuals with BMI values in that range }
\CommentTok{\#than in other ranges. Conversely, the lower density on the left{-}hand side of }
\CommentTok{\#the plot indicates that BMI values in that range are less common in the dataset.}

\CommentTok{\#Overall, the density plot provides a more continuous and detailed }
\CommentTok{\#representation of the distribution of BMI values in the dataset than the }
\CommentTok{\#histogram, which is based on discrete bins.}


\CommentTok{\# BMI Distribution}
\NormalTok{heart\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ BMI, }\AttributeTok{y =}\NormalTok{ ..density..)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ ..density..), }\AttributeTok{binwidth =} \DecValTok{1}\NormalTok{, }\AttributeTok{color =} \StringTok{"white"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"\#ADD8E6"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{color =} \StringTok{"\#0066CC"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of BMI"}\NormalTok{, }\AttributeTok{x =} \StringTok{"BMI"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Density"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
## i Please use `after_stat(density)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Distribution of Age in the data set}
\NormalTok{heart\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(AgeCategory) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ AgeCategory, }\AttributeTok{y =}\NormalTok{ n, }\AttributeTok{fill =}\NormalTok{ AgeCategory)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of Age Categories"}\NormalTok{, }\AttributeTok{x =} \StringTok{"Age Category"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Count"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Sleep Distribution Age{-}wise}
\NormalTok{heart\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ SleepTime, }\AttributeTok{fill =}\NormalTok{ AgeCategory)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \FloatTok{0.9}\NormalTok{, }\AttributeTok{position =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{7}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_viridis\_d}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Sleep Time (hrs)"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Frequency"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"Age Category"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Ditribution of female and male across different parameters}

\NormalTok{heart\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{c}\NormalTok{(Smoking, AlcoholDrinking, Stroke, KidneyDisease, SkinCancer)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(name, Sex, value) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{n =} \FunctionTok{n}\NormalTok{()) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ value, }\AttributeTok{y =}\NormalTok{ n, }\AttributeTok{fill =}\NormalTok{ name)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"\#99C7D9"}\NormalTok{, }\StringTok{"\#C2D69B"}\NormalTok{, }\StringTok{"\#FAC090"}\NormalTok{, }\StringTok{"\#FF9E9D"}\NormalTok{, }\StringTok{"\#D3C0D2"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ Sex, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{, }\AttributeTok{scales =} \StringTok{"free\_x"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{""}\NormalTok{, }\AttributeTok{y =} \StringTok{"Count"}\NormalTok{, }\AttributeTok{fill =} \StringTok{""}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{strip.background =} \FunctionTok{element\_blank}\NormalTok{(), }\AttributeTok{strip.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{), }\AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
        \AttributeTok{legend.position =} \StringTok{"bottom"}\NormalTok{, }\AttributeTok{legend.title =} \FunctionTok{element\_blank}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'name', 'Sex'. You can override using the
## `.groups` argument.
\end{verbatim}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Visualize the distribution of continuous variables using histograms}
\NormalTok{heart\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(BMI, DiffWalking, GenHealth, MentalHealth, PhysicalHealth, SleepTime) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{gather}\NormalTok{(}\AttributeTok{key =} \StringTok{"variable"}\NormalTok{, }\AttributeTok{value =} \StringTok{"value"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{value =} \FunctionTok{as.numeric}\NormalTok{(value)) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# Convert the value variable to numeric}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ value, }\AttributeTok{y =}\NormalTok{ ..density..)) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{variable, }\AttributeTok{scales =} \StringTok{"free\_x"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ ..density..), }\AttributeTok{binwidth =} \DecValTok{5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: There was 1 warning in `mutate()`.
## i In argument: `value = as.numeric(value)`.
## Caused by warning:
## ! NAs introduced by coercion
\end{verbatim}

\begin{verbatim}
## Warning: Removed 639590 rows containing non-finite values (`stat_bin()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 639590 rows containing non-finite values (`stat_density()`).
\end{verbatim}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-5.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Visualize the relationship between continuous variables using scatterplots}
\NormalTok{heart\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(AgeCategory, BMI, DiffWalking, GenHealth, MentalHealth, PhysicalHealth, SleepTime, HeartDisease) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ AgeCategory, }\AttributeTok{y =}\NormalTok{ BMI, }\AttributeTok{color =}\NormalTok{ HeartDisease)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Scatterplot of age category and BMI by heart disease"}\NormalTok{, }
       \AttributeTok{x =} \StringTok{"Age category"}\NormalTok{, }\AttributeTok{y =} \StringTok{"BMI"}\NormalTok{, }\AttributeTok{color =} \StringTok{"Heart disease"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-6.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Perform t{-}tests to compare the means of continuous variables by the presence of heart disease}

\CommentTok{\#The p{-}value is less than 2.2e{-}16, which indicates that there is strong evidence}
\CommentTok{\#to reject the null hypothesis that the means of BMI in individuals with and}
\CommentTok{\#without heart disease are equal.}
\FunctionTok{t.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{BMI }\SpecialCharTok{\textasciitilde{}}\NormalTok{ heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  heart_data$BMI by heart_data$HeartDisease
## t = -28.402, df = 32295, p-value < 2.2e-16
## alternative hypothesis: true difference in means between group No and group Yes is not equal to 0
## 95 percent confidence interval:
##  -1.258156 -1.095712
## sample estimates:
##  mean in group No mean in group Yes 
##          28.22466          29.40159
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#we can reject the null hypothesis which states that there is no significant }
\CommentTok{\#difference in the mean MentalHealth score between the groups with and without heart disease.}
\FunctionTok{t.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{MentalHealth }\SpecialCharTok{\textasciitilde{}}\NormalTok{ heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  heart_data$MentalHealth by heart_data$HeartDisease
## t = -14.189, df = 31219, p-value < 2.2e-16
## alternative hypothesis: true difference in means between group No and group Yes is not equal to 0
## 95 percent confidence interval:
##  -0.9252877 -0.7006833
## sample estimates:
##  mean in group No mean in group Yes 
##          3.828778          4.641764
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#we can reject the null hypothesis which states that there is no significant }
\CommentTok{\#difference in the mean PhysicalHealth score between the groups with and without heart disease.}
\FunctionTok{t.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{PhysicalHealth }\SpecialCharTok{\textasciitilde{}}\NormalTok{ heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  heart_data$PhysicalHealth by heart_data$HeartDisease
## t = -68.557, df = 29536, p-value < 2.2e-16
## alternative hypothesis: true difference in means between group No and group Yes is not equal to 0
## 95 percent confidence interval:
##  -4.990539 -4.713113
## sample estimates:
##  mean in group No mean in group Yes 
##          2.956416          7.808242
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#we can reject the null hypothesis which states that there is no significant }
\CommentTok{\#difference in the mean Sleeptime score between the groups with and without heart disease.}
\FunctionTok{t.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{SleepTime }\SpecialCharTok{\textasciitilde{}}\NormalTok{ heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  heart_data$SleepTime by heart_data$HeartDisease
## t = -3.8607, df = 30618, p-value = 0.0001133
## alternative hypothesis: true difference in means between group No and group Yes is not equal to 0
## 95 percent confidence interval:
##  -0.06443848 -0.02104092
## sample estimates:
##  mean in group No mean in group Yes 
##          7.093416          7.136156
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Perform chi{-}squared tests to compare the proportions of categorical variables }
\CommentTok{\#by the presence of heart disease}

\CommentTok{\#very small p{-}value (less than 2.2e{-}16). This indicates strong evidence against }
\CommentTok{\# the null hypothesis, and suggests that there is a significant association between }
\CommentTok{\#smoking and heart disease in the sample.}

\CommentTok{\#likewise for the rest of the variables as well}

\FunctionTok{chisq.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{Smoking, heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Pearson's Chi-squared test with Yates' continuity correction
## 
## data:  heart_data$Smoking and heart_data$HeartDisease
## X-squared = 3713, df = 1, p-value < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{chisq.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{AlcoholDrinking, heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Pearson's Chi-squared test with Yates' continuity correction
## 
## data:  heart_data$AlcoholDrinking and heart_data$HeartDisease
## X-squared = 328.65, df = 1, p-value < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{chisq.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{Stroke, heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Pearson's Chi-squared test with Yates' continuity correction
## 
## data:  heart_data$Stroke and heart_data$HeartDisease
## X-squared = 12386, df = 1, p-value < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{chisq.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{Sex, heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Pearson's Chi-squared test with Yates' continuity correction
## 
## data:  heart_data$Sex and heart_data$HeartDisease
## X-squared = 1568.3, df = 1, p-value < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{chisq.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{Race, heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Pearson's Chi-squared test
## 
## data:  heart_data$Race and heart_data$HeartDisease
## X-squared = 844.31, df = 5, p-value < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{chisq.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{Diabetic, heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Pearson's Chi-squared test
## 
## data:  heart_data$Diabetic and heart_data$HeartDisease
## X-squared = 10960, df = 3, p-value < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{chisq.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{PhysicalActivity, heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Pearson's Chi-squared test with Yates' continuity correction
## 
## data:  heart_data$PhysicalActivity and heart_data$HeartDisease
## X-squared = 3199, df = 1, p-value < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{chisq.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{Asthma, heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Pearson's Chi-squared test with Yates' continuity correction
## 
## data:  heart_data$Asthma and heart_data$HeartDisease
## X-squared = 548.85, df = 1, p-value < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{chisq.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{KidneyDisease, heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Pearson's Chi-squared test with Yates' continuity correction
## 
## data:  heart_data$KidneyDisease and heart_data$HeartDisease
## X-squared = 6739.2, df = 1, p-value < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{chisq.test}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{SkinCancer, heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Pearson's Chi-squared test with Yates' continuity correction
## 
## data:  heart_data$SkinCancer and heart_data$HeartDisease
## X-squared = 2783.6, df = 1, p-value < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Fit a logistic regression model to identify significant predictors of heart disease}
\CommentTok{\# Converting the hear disease column to 0 and 1 }
\NormalTok{heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(heart\_data}\SpecialCharTok{$}\NormalTok{HeartDisease }\SpecialCharTok{==} \StringTok{"No"}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}

\NormalTok{heart\_model }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(HeartDisease }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ heart\_data, }\AttributeTok{family =}\NormalTok{ binomial)}

\CommentTok{\#Based on this output, BMI, Smoking(Yes), AlcoholDrinking(Yes), Stroke(Yes), }
\CommentTok{\#PhysicalHealth, MentalHealth, DiffWalking(Yes), Sex(Male), AgeCategory, }
\CommentTok{\#Diabetic(Yes), GenHealthFair, GenHealthGood, GenHealthPoor, GenHealthVeryGood, }
\CommentTok{\#SleepTime, and Asthma(Yes) are all statistically significant predictors of heart disease.}


\CommentTok{\#AgeCategory25{-}29, DiabeticYes (during pregnancy), PhysicalActivityYes, RaceOther,}
\CommentTok{\#and RaceWhite are not statistically significant predictors of heart disease.}

\CommentTok{\#The z{-}score is used to assess the statistical significance of each variable in}
\CommentTok{\#the model. The larger the absolute value of the z{-}score, the further the estimate}
\CommentTok{\#of the coefficient is from zero, indicating a greater impact on the outcome variable}

\FunctionTok{summary}\NormalTok{(heart\_model)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = HeartDisease ~ ., family = binomial, data = heart_data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.1278  -0.4108  -0.2440  -0.1295   3.6087  
## 
## Coefficients:
##                                   Estimate Std. Error z value Pr(>|z|)    
## (Intercept)                     -6.2935985  0.1147521 -54.845  < 2e-16 ***
## BMI                              0.0084849  0.0011442   7.415 1.21e-13 ***
## SmokingYes                       0.3563393  0.0143727  24.793  < 2e-16 ***
## AlcoholDrinkingYes              -0.2404857  0.0335303  -7.172 7.38e-13 ***
## StrokeYes                        1.0470172  0.0226326  46.261  < 2e-16 ***
## PhysicalHealth                   0.0031770  0.0008632   3.681 0.000233 ***
## MentalHealth                     0.0047165  0.0008827   5.343 9.12e-08 ***
## DiffWalkingYes                   0.2129965  0.0181484  11.736  < 2e-16 ***
## SexMale                          0.7079573  0.0145679  48.597  < 2e-16 ***
## AgeCategory25-29                 0.1266777  0.1241825   1.020 0.307684    
## AgeCategory30-34                 0.4862160  0.1110927   4.377 1.21e-05 ***
## AgeCategory35-39                 0.5946781  0.1063731   5.590 2.26e-08 ***
## AgeCategory40-44                 0.9957684  0.1000696   9.951  < 2e-16 ***
## AgeCategory45-49                 1.3185963  0.0964945  13.665  < 2e-16 ***
## AgeCategory50-54                 1.7273683  0.0931522  18.544  < 2e-16 ***
## AgeCategory55-59                 1.9646188  0.0916901  21.427  < 2e-16 ***
## AgeCategory60-64                 2.2268220  0.0908512  24.511  < 2e-16 ***
## AgeCategory65-69                 2.4688649  0.0905765  27.257  < 2e-16 ***
## AgeCategory70-74                 2.7544487  0.0905120  30.432  < 2e-16 ***
## AgeCategory75-79                 2.9565214  0.0910504  32.471  < 2e-16 ***
## AgeCategory80 or older           3.2142065  0.0907969  35.400  < 2e-16 ***
## RaceAsian                       -0.5366015  0.0841277  -6.378 1.79e-10 ***
## RaceBlack                       -0.3459636  0.0577517  -5.991 2.09e-09 ***
## RaceHispanic                    -0.2549177  0.0588305  -4.333 1.47e-05 ***
## RaceOther                       -0.0611086  0.0639976  -0.955 0.339649    
## RaceWhite                       -0.0781639  0.0515923  -1.515 0.129765    
## DiabeticNo, borderline diabetes  0.1289554  0.0418233   3.083 0.002047 ** 
## DiabeticYes                      0.4770059  0.0167216  28.526  < 2e-16 ***
## DiabeticYes (during pregnancy)   0.1234766  0.1050702   1.175 0.239922    
## PhysicalActivityYes              0.0198827  0.0160701   1.237 0.215994    
## GenHealthFair                    1.5194699  0.0328658  46.232  < 2e-16 ***
## GenHealthGood                    1.0457251  0.0295919  35.338  < 2e-16 ***
## GenHealthPoor                    1.8995671  0.0409498  46.388  < 2e-16 ***
## GenHealthVery good               0.4713771  0.0303711  15.521  < 2e-16 ***
## SleepTime                       -0.0250549  0.0043391  -5.774 7.73e-09 ***
## AsthmaYes                        0.2775421  0.0192197  14.440  < 2e-16 ***
## KidneyDiseaseYes                 0.5684066  0.0244035  23.292  < 2e-16 ***
## SkinCancerYes                    0.1144361  0.0195037   5.867 4.43e-09 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 186906  on 319794  degrees of freedom
## Residual deviance: 145150  on 319757  degrees of freedom
## AIC: 145226
## 
## Number of Fisher Scoring iterations: 7
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}

\CommentTok{\# Heart\_Data:Health\_Metrics}

\NormalTok{heart\_health }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"heart.csv"}\NormalTok{)}

\FunctionTok{str}\NormalTok{(heart\_health)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    918 obs. of  12 variables:
##  $ Age           : int  40 49 37 48 54 39 45 54 37 48 ...
##  $ Sex           : chr  "M" "F" "M" "F" ...
##  $ ChestPainType : chr  "ATA" "NAP" "ATA" "ASY" ...
##  $ RestingBP     : int  140 160 130 138 150 120 130 110 140 120 ...
##  $ Cholesterol   : int  289 180 283 214 195 339 237 208 207 284 ...
##  $ FastingBS     : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ RestingECG    : chr  "Normal" "Normal" "ST" "Normal" ...
##  $ MaxHR         : int  172 156 98 108 122 170 170 142 130 120 ...
##  $ ExerciseAngina: chr  "N" "N" "N" "Y" ...
##  $ Oldpeak       : num  0 1 0 1.5 0 0 0 0 1.5 0 ...
##  $ ST_Slope      : chr  "Up" "Flat" "Up" "Flat" ...
##  $ HeartDisease  : int  0 1 0 1 0 0 0 0 1 0 ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(heart\_health)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       Age            Sex            ChestPainType        RestingBP    
##  Min.   :28.00   Length:918         Length:918         Min.   :  0.0  
##  1st Qu.:47.00   Class :character   Class :character   1st Qu.:120.0  
##  Median :54.00   Mode  :character   Mode  :character   Median :130.0  
##  Mean   :53.51                                         Mean   :132.4  
##  3rd Qu.:60.00                                         3rd Qu.:140.0  
##  Max.   :77.00                                         Max.   :200.0  
##   Cholesterol      FastingBS       RestingECG            MaxHR      
##  Min.   :  0.0   Min.   :0.0000   Length:918         Min.   : 60.0  
##  1st Qu.:173.2   1st Qu.:0.0000   Class :character   1st Qu.:120.0  
##  Median :223.0   Median :0.0000   Mode  :character   Median :138.0  
##  Mean   :198.8   Mean   :0.2331                      Mean   :136.8  
##  3rd Qu.:267.0   3rd Qu.:0.0000                      3rd Qu.:156.0  
##  Max.   :603.0   Max.   :1.0000                      Max.   :202.0  
##  ExerciseAngina        Oldpeak          ST_Slope          HeartDisease   
##  Length:918         Min.   :-2.6000   Length:918         Min.   :0.0000  
##  Class :character   1st Qu.: 0.0000   Class :character   1st Qu.:0.0000  
##  Mode  :character   Median : 0.6000   Mode  :character   Median :1.0000  
##                     Mean   : 0.8874                      Mean   :0.5534  
##                     3rd Qu.: 1.5000                      3rd Qu.:1.0000  
##                     Max.   : 6.2000                      Max.   :1.0000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(heart\_health))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(heart\_health, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Age)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{20}\NormalTok{, }\AttributeTok{fill =} \StringTok{"skyblue"}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of Age"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-7.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(heart\_health, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ RestingBP)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{20}\NormalTok{, }\AttributeTok{fill =} \StringTok{"skyblue"}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of Resting Blood Pressure"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-8.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(heart\_health, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Cholesterol)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{20}\NormalTok{, }\AttributeTok{fill =} \StringTok{"skyblue"}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of Serum Cholesterol"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-9.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(heart\_health, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ MaxHR)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{20}\NormalTok{, }\AttributeTok{fill =} \StringTok{"skyblue"}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of Maximum Heart Rate Achieved"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-10.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(heart\_health, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Oldpeak)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{20}\NormalTok{, }\AttributeTok{fill =} \StringTok{"skyblue"}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of Oldpeak"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-11.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Visualize the proportion of categorical variables}
\FunctionTok{ggplot}\NormalTok{(heart\_health, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Sex, }\AttributeTok{fill =}\NormalTok{ Sex)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{, }\AttributeTok{width =} \FloatTok{0.45}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"skyblue"}\NormalTok{, }\StringTok{"pink"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of Sex"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-12.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(heart\_health, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ ChestPainType, }\AttributeTok{fill =}\NormalTok{ ChestPainType)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{, }\AttributeTok{width =} \FloatTok{0.45}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Blues"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of Chest Pain Type"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-13.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(heart\_health, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ FastingBS, }\AttributeTok{fill =}\NormalTok{ FastingBS)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{, }\AttributeTok{width =} \FloatTok{0.45}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"skyblue"}\NormalTok{, }\StringTok{"pink"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of Fasting Blood Sugar"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: The following aesthetics were dropped during statistical transformation: fill
## i This can happen when ggplot fails to infer the correct grouping structure in
##   the data.
## i Did you forget to specify a `group` aesthetic or to convert a numerical
##   variable into a factor?
\end{verbatim}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-14.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(heart\_health, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ RestingECG, }\AttributeTok{fill =}\NormalTok{ RestingECG)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{, }\AttributeTok{width =} \FloatTok{0.45}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"YlOrBr"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of Resting Electrocardiogram Results"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-15.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(heart\_health, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ ExerciseAngina, }\AttributeTok{fill =}\NormalTok{ ExerciseAngina)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{, }\AttributeTok{width =} \FloatTok{0.45}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"skyblue"}\NormalTok{, }\StringTok{"pink"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of Exercise Induced Angina"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-16.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(heart\_health, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ ST\_Slope, }\AttributeTok{fill =}\NormalTok{ ST\_Slope)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{, }\AttributeTok{width =} \FloatTok{0.45}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"YlGnBu"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of ST Slope"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Final_project_files/figure-latex/unnamed-chunk-1-17.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# performing some statistical tests}
\CommentTok{\#The 95\% confidence interval suggests that the true mean age of individuals }
\CommentTok{\#without heart disease is between 4.16 and 6.54 years younger than the mean age }
\CommentTok{\#of individuals with heart disease.}
\FunctionTok{t.test}\NormalTok{(Age }\SpecialCharTok{\textasciitilde{}}\NormalTok{ HeartDisease, }\AttributeTok{data =}\NormalTok{ heart\_health)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  Age by HeartDisease
## t = -8.8225, df = 843.69, p-value < 2.2e-16
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -6.538260 -4.158513
## sample estimates:
## mean in group 0 mean in group 1 
##        50.55122        55.89961
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Can reject the null and state there is a significant different between }
\CommentTok{\# the values for patients with heart disease and without heart disease}
\FunctionTok{t.test}\NormalTok{(RestingBP }\SpecialCharTok{\textasciitilde{}}\NormalTok{ HeartDisease, }\AttributeTok{data =}\NormalTok{ heart\_health)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  RestingBP by HeartDisease
## t = -3.3395, df = 915.14, p-value = 0.0008732
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -6.357955 -1.651148
## sample estimates:
## mean in group 0 mean in group 1 
##        130.1805        134.1850
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# even in this we can reject the null hypothesis as the p value is significantly low}
\FunctionTok{t.test}\NormalTok{(Cholesterol }\SpecialCharTok{\textasciitilde{}}\NormalTok{ HeartDisease, }\AttributeTok{data =}\NormalTok{ heart\_health)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  Cholesterol by HeartDisease
## t = 7.6269, df = 844.36, p-value = 6.481e-14
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  38.00953 64.35249
## sample estimates:
## mean in group 0 mean in group 1 
##        227.1220        175.9409
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Can reject the null as there is a significant diference in the means for the}
\CommentTok{\# patients with heart disease and with out heart disease}
\FunctionTok{t.test}\NormalTok{(MaxHR }\SpecialCharTok{\textasciitilde{}}\NormalTok{ HeartDisease, }\AttributeTok{data =}\NormalTok{ heart\_health)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  MaxHR by HeartDisease
## t = 13.231, df = 877.04, p-value < 2.2e-16
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  17.45551 23.53591
## sample estimates:
## mean in group 0 mean in group 1 
##        148.1512        127.6555
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{heart\_model\_1 }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(HeartDisease }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ heart\_health, }\AttributeTok{family =}\NormalTok{ binomial)}

\CommentTok{\#Sex, ChestPainTypeATA, ChestPainTypeNAP, ChestPainTypeTA, Cholesterol, FastingBS,}
\CommentTok{\#ExerciseAnginaY, Oldpeak, and ST\_SlopeFlat these variables are statistically }
\CommentTok{\#significant in predicting the likelihood of having heart disease}
\FunctionTok{summary}\NormalTok{(heart\_model\_1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = HeartDisease ~ ., family = binomial, data = heart_health)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.6531  -0.3747   0.1745   0.4457   2.5778  
## 
## Coefficients:
##                   Estimate Std. Error z value Pr(>|z|)    
## (Intercept)      -1.163656   1.416003  -0.822 0.411197    
## Age               0.016550   0.013197   1.254 0.209803    
## SexM              1.466477   0.279834   5.241 1.60e-07 ***
## ChestPainTypeATA -1.830289   0.326293  -5.609 2.03e-08 ***
## ChestPainTypeNAP -1.685682   0.266001  -6.337 2.34e-10 ***
## ChestPainTypeTA  -1.488392   0.432572  -3.441 0.000580 ***
## RestingBP         0.004194   0.006010   0.698 0.485296    
## Cholesterol      -0.004115   0.001087  -3.785 0.000154 ***
## FastingBS         1.136482   0.274999   4.133 3.59e-05 ***
## RestingECGNormal -0.177033   0.271925  -0.651 0.515022    
## RestingECGST     -0.268546   0.350020  -0.767 0.442945    
## MaxHR            -0.004288   0.005023  -0.854 0.393249    
## ExerciseAnginaY   0.900292   0.244513   3.682 0.000231 ***
## Oldpeak           0.380643   0.118466   3.213 0.001313 ** 
## ST_SlopeFlat      1.453902   0.429086   3.388 0.000703 ***
## ST_SlopeUp       -0.994101   0.450196  -2.208 0.027234 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1262.14  on 917  degrees of freedom
## Residual deviance:  594.19  on 902  degrees of freedom
## AIC: 626.19
## 
## Number of Fisher Scoring iterations: 6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# }
\CommentTok{\# \#\# Plot one}
\CommentTok{\# heart\_data \%\textgreater{}\%}
\CommentTok{\#   select(AgeCategory, BMI, DiffWalking, GenHealth, MentalHealth, PhysicalHealth, SleepTime, HeartDisease) \%\textgreater{}\%}
\CommentTok{\#   mutate(HeartDisease = factor(HeartDisease)) \%\textgreater{}\%}
\CommentTok{\#   ggplot(aes(x = AgeCategory, y = BMI, color = HeartDisease)) +}
\CommentTok{\#   geom\_point() +}
\CommentTok{\#   scale\_color\_manual(values = c("\#800001", "\#4B4B4C")) +}
\CommentTok{\#   labs(title = bquote(atop("BMI vs Age Category by Heart Disease", atop(bold(""), ""))),}
\CommentTok{\#        x = "Age category", y = "BMI", color = "Heart disease") +}
\CommentTok{\#   theme(plot.title = element\_text(size = 14, face = "bold"),}
\CommentTok{\#         axis.title.x = element\_text(size = 12),}
\CommentTok{\#         axis.title.y = element\_text(size = 12),}
\CommentTok{\#         axis.text.x = element\_text(size = 12, angle = 45, hjust = 1),}
\CommentTok{\#         axis.text.y = element\_text(size = 12),}
\CommentTok{\#         legend.title = element\_text(size = 12),}
\CommentTok{\#         legend.text = element\_text(size = 12),}
\CommentTok{\#         panel.grid.major = element\_blank(),}
\CommentTok{\#         panel.grid.minor = element\_blank(),}
\CommentTok{\#         panel.border = element\_blank(),}
\CommentTok{\#         panel.background = element\_blank(),}
\CommentTok{\#         axis.line = element\_line(size = .5, color = "black"))}
\CommentTok{\# }
\CommentTok{\# }
\CommentTok{\# }
\CommentTok{\# \#\# plot 2}
\CommentTok{\# heart\_data \%\textgreater{}\%}
\CommentTok{\#   group\_by(Smoking, HeartDisease) \%\textgreater{}\%}
\CommentTok{\#   summarise(count = n()) \%\textgreater{}\%}
\CommentTok{\#   group\_by(Smoking) \%\textgreater{}\%}
\CommentTok{\#   mutate(percent = count / sum(count) * 100,}
\CommentTok{\#          HD\_Yes\_percent = percent[HeartDisease == 1]) \%\textgreater{}\%}
\CommentTok{\#   ggplot(aes(x = Smoking, y = percent, fill = as.factor(HeartDisease))) +}
\CommentTok{\#   geom\_col(position = "dodge", width = 0.5) +}
\CommentTok{\#   scale\_y\_continuous(labels = scales::percent\_format(scale = 1), limits = c(0, 100), breaks = seq(0, 100, 10)) +}
\CommentTok{\#   geom\_text(aes(label = paste0(round(percent), "\%")), }
\CommentTok{\#             position = position\_dodge(width = 0.5), size = 4, vjust = {-}.5,hjust= 0.3) +}
\CommentTok{\#   labs(title = " Impact of Smoking on Heart Disease", }
\CommentTok{\#        x = "Smoking status", y = "Percentage",}
\CommentTok{\#        fill = "Heart disease status") +}
\CommentTok{\#   scale\_fill\_manual(values = c("\#800001", "\#4B4B4C"),}
\CommentTok{\#                     labels = c("No", "Yes"),}
\CommentTok{\#                     name = "Heart disease")}
\CommentTok{\# }
\CommentTok{\# }
\CommentTok{\# \# Visualization 3: Boxplot of Physical Health by Heart Disease}
\CommentTok{\# }
\CommentTok{\# }
\CommentTok{\# heart\_data \%\textgreater{}\%}
\CommentTok{\#   group\_by(HeartDisease) \%\textgreater{}\%}
\CommentTok{\#   summarise(mean\_PhysicalHealth = mean(PhysicalHealth)) \%\textgreater{}\%}
\CommentTok{\#   ggplot(aes(x = as.factor(HeartDisease), y = mean\_PhysicalHealth, fill = as.factor(HeartDisease))) +}
\CommentTok{\#   geom\_col() +}
\CommentTok{\#   scale\_fill\_manual(values = c("\#800001", "\#4B4B4C"),}
\CommentTok{\#                     labels = c("No", "Yes"),}
\CommentTok{\#                     name = "Heart disease") +}
\CommentTok{\#   labs(title = "Impact of Health Scores on heart disease", }
\CommentTok{\#        x = "Heart disease status", y = "Mean physical health score") }
\CommentTok{\# }
\CommentTok{\# }
\CommentTok{\# \# Plot 4}
\CommentTok{\# heart\_data \%\textgreater{}\%}
\CommentTok{\#   mutate(HeartDisease = as.factor(HeartDisease)) \%\textgreater{}\%}
\CommentTok{\#   group\_by(Sex, HeartDisease) \%\textgreater{}\%}
\CommentTok{\#   summarise(count = n()) \%\textgreater{}\%}
\CommentTok{\#   mutate(percent = count/sum(count) * 100) \%\textgreater{}\%}
\CommentTok{\#   ggplot(aes(x = Sex, y = percent, fill = HeartDisease)) +}
\CommentTok{\#   geom\_bar(position = "dodge", stat = "identity") +}
\CommentTok{\#   geom\_text(aes(label = scales::percent(percent/100), }
\CommentTok{\#                 y = percent+2),}
\CommentTok{\#             position = position\_dodge(width = 0.9),}
\CommentTok{\#             size = 3) +}
\CommentTok{\#   ggtitle("Heart Disease by Gender") +}
\CommentTok{\#   scale\_fill\_manual(values = c("\#800001", "\#4B4B4C"), }
\CommentTok{\#                     labels = c("No", "Yes"),}
\CommentTok{\#                     name = "Heart Disease") +}
\CommentTok{\#   labs(x = "Gender", y = "Percentage") +}
\CommentTok{\#   scale\_y\_continuous(labels = scales::percent\_format(scale = 1), limits = c(0, 100))}
\CommentTok{\# }
\CommentTok{\# }
\CommentTok{\# \#plot 5}
\CommentTok{\# \# library(gridExtra)}
\CommentTok{\# \# library(ggpubr)}
\CommentTok{\# \# }
\CommentTok{\# \# \# Subset the data for males and females}
\CommentTok{\# \# heart\_health\_male \textless{}{-} filter(heart\_health, Sex == "M")}
\CommentTok{\# \# heart\_health\_female \textless{}{-} filter(heart\_health, Sex == "F")}
\CommentTok{\# \# }
\CommentTok{\# \# \# Create a nested pie chart function}
\CommentTok{\# \# nested\_pie \textless{}{-} function(data, title)\{}
\CommentTok{\# \#   ggpie(data = select(data, count, HeartDisease), values = "count", label = "HeartDisease", }
\CommentTok{\# \#         ggtheme = theme\_void(), fill = "HeartDisease",}
\CommentTok{\# \#         title = title, label\_font = 12)}
\CommentTok{\# \# \}}
\CommentTok{\# \# }
\CommentTok{\# \# \# Create the pie charts for males and females}
\CommentTok{\# \# ggarrange(}
\CommentTok{\# \#   ggplot(heart\_health\_male, aes(x = "", fill = ChestPainType)) +}
\CommentTok{\# \#     geom\_bar(width = 1) +}
\CommentTok{\# \#     facet\_wrap(\textasciitilde{}Sex) +}
\CommentTok{\# \#     coord\_polar(theta = "y") +}
\CommentTok{\# \#     theme\_void() +}
\CommentTok{\# \#     ggtitle("Chest Pain Type by Sex") +}
\CommentTok{\# \#     theme(legend.position = "bottom") +}
\CommentTok{\# \#     labs(fill = "Chest Pain Type"),}
\CommentTok{\# \#   }
\CommentTok{\# \#   nested\_pie(data = heart\_health\_male \%\textgreater{}\% }
\CommentTok{\# \#                group\_by(Sex, ChestPainType, HeartDisease) \%\textgreater{}\% }
\CommentTok{\# \#                summarise(count = n()),}
\CommentTok{\# \#              title = "Heart Disease Status"),}
\CommentTok{\# \#   }
\CommentTok{\# \#   ggplot(heart\_health\_female, aes(x = "", fill = ChestPainType)) +}
\CommentTok{\# \#     geom\_bar(width = 1) +}
\CommentTok{\# \#     facet\_wrap(\textasciitilde{}Sex) +}
\CommentTok{\# \#     coord\_polar(theta = "y") +}
\CommentTok{\# \#     theme\_void() +}
\CommentTok{\# \#     ggtitle("Chest Pain Type by Sex") +}
\CommentTok{\# \#     theme(legend.position = "bottom") +}
\CommentTok{\# \#     labs(fill = "Chest Pain Type"),}
\CommentTok{\# \#   }
\CommentTok{\# \#   nested\_pie(data = heart\_health\_female \%\textgreater{}\% }
\CommentTok{\# \#                group\_by(Sex, ChestPainType, HeartDisease) \%\textgreater{}\% }
\CommentTok{\# \#                summarise(count = n()),}
\CommentTok{\# \#              title = "Heart Disease Status"),}
\CommentTok{\# \#   }
\CommentTok{\# \#   nrow = 2, ncol = 2}
\CommentTok{\# \# )}
\CommentTok{\# }
\CommentTok{\# \#plot 5}
\CommentTok{\# \# Subset the data for males and females}
\CommentTok{\# heart\_health\_male \textless{}{-} subset(heart\_health, Sex == "M")}
\CommentTok{\# heart\_health\_female \textless{}{-} subset(heart\_health, Sex == "F")}
\CommentTok{\# }
\CommentTok{\# \# Define the color palette for heart disease status}
\CommentTok{\# color\_palette \textless{}{-} c("\#800001", "\#4B4B4C")}
\CommentTok{\# }
\CommentTok{\# \# Create a grouped bar chart for males}
\CommentTok{\# ggplot(data = heart\_health\_male, aes(x = ChestPainType, fill = factor(HeartDisease))) +}
\CommentTok{\#   geom\_bar(position = position\_dodge(), width = .8) +}
\CommentTok{\#   scale\_fill\_manual(values = color\_palette, labels = c("No", "Yes"),}
\CommentTok{\#                     name = "Heart disease") +}
\CommentTok{\#   labs(x = "Chest Pain Type", y = "Count", title = "Heart Disease by Chest Pain Type{-}Males") +}
\CommentTok{\#   theme\_minimal() +}
\CommentTok{\#   theme(plot.title = element\_text(size = 14, face = "bold"),}
\CommentTok{\#         axis.title.x = element\_text(size = 12),}
\CommentTok{\#         axis.title.y = element\_text(size = 12),}
\CommentTok{\#         axis.text.x = element\_text(size = 12),}
\CommentTok{\#         axis.text.y = element\_text(size = 12),}
\CommentTok{\#         legend.title = element\_text(size = 12),}
\CommentTok{\#         legend.text = element\_text(size = 12),}
\CommentTok{\#         panel.grid.major = element\_blank(),}
\CommentTok{\#         panel.grid.minor = element\_blank(),}
\CommentTok{\#         panel.border = element\_blank(),}
\CommentTok{\#         panel.background = element\_blank(),}
\CommentTok{\#         axis.line = element\_line(size = .5, color = "black")) +}
\CommentTok{\#   geom\_text(aes(label=..count..), stat=\textquotesingle{}count\textquotesingle{}, position=position\_dodge(width=0.8), vjust={-}0.5,hjust=0.7, size=4)}
\CommentTok{\# }
\CommentTok{\# \# Create a grouped bar chart for females}
\CommentTok{\# ggplot(data = heart\_health\_female, aes(x = ChestPainType, fill = factor(HeartDisease))) +}
\CommentTok{\#   geom\_bar(position = position\_dodge(), width = 0.8) +}
\CommentTok{\#   scale\_fill\_manual(values = color\_palette, labels = c("No", "Yes"),}
\CommentTok{\#                     name = "Heart disease") +}
\CommentTok{\#   labs(x = "Chest Pain Type", y = "Count", title = "Heart Disease by Chest Pain Type{-}Females") +}
\CommentTok{\#   theme\_minimal() +}
\CommentTok{\#   theme(plot.title = element\_text(size = 14, face = "bold"),}
\CommentTok{\#         axis.title.x = element\_text(size = 12),}
\CommentTok{\#         axis.title.y = element\_text(size = 12),}
\CommentTok{\#         axis.text.x = element\_text(size = 12),}
\CommentTok{\#         axis.text.y = element\_text(size = 12),}
\CommentTok{\#         legend.title = element\_text(size = 12),}
\CommentTok{\#         legend.text = element\_text(size = 12),}
\CommentTok{\#         panel.grid.major = element\_blank(),}
\CommentTok{\#         panel.grid.minor = element\_blank(),}
\CommentTok{\#         panel.border = element\_blank(),}
\CommentTok{\#         panel.background = element\_blank(),}
\CommentTok{\#         axis.line = element\_line(size = 0.5, color = "black")) +}
\CommentTok{\#   geom\_text(aes(label=..count..), stat=\textquotesingle{}count\textquotesingle{}, position=position\_dodge(width=0.8), vjust={-}0.5,hjust=0.7, size=4)}
\CommentTok{\# }
\end{Highlighting}
\end{Shaded}


\end{document}
